<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ishaanshares</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">

    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: Arial, sans-serif;
            background-image: url('default-background.jpg');
            background-size: cover;
            transition: background 0.5s ease;
            padding: 0;
            margin: 0;
            overflow-x: hidden;
        }

        .navbar {
            background: #000;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }

        .navbar-nav .nav-link {
            color: #e0e0e0 !important;
        }

        .navbar-nav .nav-link:hover {
            color: #fff !important;
        }

        .navbar .dropdown-menu {
            background-color: #333;
        }

        .navbar .dropdown-item {
            color: #e0e0e0;
        }

        .navbar .dropdown-item:hover {
            background-color: #444;
            color: #fff;
        }

        .section {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            padding: 2rem;
            border-radius: 10px;
            margin-top: 2rem;
        }

        .progress {
            height: 20px;
        }

        .loading-spinner {
            display: none;
        }

        .hidden-file-input {
            display: none;
        }

        .status {
            color: #4caf50;
            font-size: 1.2rem;
            text-align: center;
            margin-top: 20px;
        }

        .footer {
            background-color: #000;
            color: #e0e0e0;
            padding: 1rem;
            text-align: center;
            margin-top: 2rem;
            box-shadow: 0 -4px 8px rgba(0, 0, 0, 0.5);
        }

        .footer a {
            color: #e0e0e0;
            text-decoration: none;
        }

        .footer a:hover {
            color: #fff;
        }

        .header {
            text-align: center;
            padding: 5rem 0;
            background-color: rgba(18, 18, 18, 0.7);
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }

        .header h1 {
            font-size: 3rem;
            color: #fff;
        }

        .header p {
            color: #bbb;
            font-size: 1.2rem;
        }

        .header a {
            color: #e0e0e0;
            text-decoration: none;
        }

        .header a:hover {
            color: #fff;
        }

        .btn-primary {
            background-color: #4caf50;
            border-color: #4caf50;
        }

        .btn-primary:hover {
            background-color: #45a049;
            border-color: #45a049;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Ishaanshares</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="#share">Share Post</a></li>
                    <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Login
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Login</a></li>
                            <li><a class="dropdown-item" href="#">Register</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <input type="file" id="backgroundUpload" class="hidden-file-input" accept="image/*" onchange="changeBackground(event)">
                        <a class="nav-link" href="javascript:void(0)" onclick="document.getElementById('backgroundUpload').click()">Change Background</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <header class="header">
        <h1>Ishaanshares</h1>
        <p>Effortlessly share your posts with our automated tool!</p>
        <a href="#share" class="btn btn-primary">Start Sharing</a>
    </header>

    <section id="share" class="container py-5 section">
        <h2 class="text-center" style="color: #f8f8f8;">Auto Share Your Posts</h2>
        <form id="shareForm" class="p-4 shadow">
            <div class="mb-3">
                <label for="cookies" class="form-label">Facebook Cookie</label>
                <input type="text" id="cookies" class="form-control" placeholder="Enter your Facebook cookie" required>
            </div>
            <div class="mb-3">
                <label for="urls" class="form-label">Post URL</label>
                <input type="url" id="urls" class="form-control" placeholder="Enter the post URL" required>
            </div>
            <div class="mb-3">
                <label for="amounts" class="form-label">Number of Shares</label>
                <input type="number" id="amounts" class="form-control" min="1" max="200000" placeholder="Enter the number of shares" required>
            </div>
            <div class="mb-3">
                <label for="intervals" class="form-label">Interval (seconds)</label>
                <input type="number" id="intervals" class="form-control" min="1" max="60" placeholder="Enter interval between shares" required>
            </div>
            <button type="submit" id="submit-button" class="btn btn-primary w-100">Start Sharing</button>
        </form>
        <div id="result" class="mt-3 text-center"></div>
    </section>

    <section id="about" class="container py-5 section">
        <h2 class="text-center" style="color: #f8f8f8;">About Ishaanshares</h2>
        <p class="text-center" style="color: #bbb;">
            Ishaanshares is a powerful tool designed to help you automatically share posts on Facebook. Simply provide your Facebook cookie, post URL, the number of shares, and the interval between each share, and our automated system will do the rest. Built by Ishaan and powered by the husband of Ishaan, it's the easiest way to share posts quickly and efficiently.
        </p>
    </section>

    <div class="status" id="serverStatus">Server status: Checking...</div>

    <footer class="footer">
        <p>Made by <strong>Ishaan</strong> | Powered by <strong>The Husband of Ishaan</strong></p>
    </footer>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="username" class="form-label">Username</label>
                            <input type="text" id="username" class="form-control" placeholder="Enter username" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" id="password" class="form-control" placeholder="Enter password" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Login</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.getElementById('shareForm').addEventListener('submit', submitForm);

        // Change background image
        function changeBackground(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function (e) {
                document.body.style.backgroundImage = `url(${e.target.result})`;
            };
            reader.readAsDataURL(file);
        }

        // Form submission handler
        async function submitForm(event) {
            event.preventDefault();

            const result = document.getElementById('result');
            const button = document.getElementById('submit-button');
            const cookies = document.getElementById('cookies').value.trim();
            const url = document.getElementById('urls').value.trim();
            const amount = document.getElementById('amounts').value.trim();
            const interval = document.getElementById('intervals').value.trim();

            if (!cookies || !url || !amount || !interval) {
                result.textContent = 'Please fill up all form fields.';
                return;
            }

            button.disabled = true;
            result.textContent = 'Processing...';

            try {
                // Log the form data to ensure they're correct
                console.log('Form Data:', { cookies, url, amount, interval });

                // Attempt to parse the cookies as JSON if it's a valid JSON string
                let cookiesArray = [];
                try {
                    cookiesArray = JSON.parse(cookies);
                } catch (error) {
                    cookiesArray = cookies.split(';').map(cookie => {
                        const parts = cookie.split('=');
                        if (parts.length === 2) {
                            const [key, value] = parts;
                            return {
                                key: key.trim(),
                                value: value.trim(),
                                domain: '.facebook.com',
                                path: '/'
                            };
                        } else {
                            return null;
                        }
                    }).filter(cookie => cookie !== null);
                }

                if (cookiesArray.length === 0) {
                    result.textContent = 'No valid cookies provided.';
                    return;
                }

                console.log('Formatted Cookies:', cookiesArray);

                // Send the request to the backend
                const response = await fetch('https://spamshare-api-git-main-lucifurges-projects-fee914f5.vercel.app/api/spam', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        fbLink: url,
                        shareCount: parseInt(amount),
                        interval: parseFloat(interval),
                        cookies: cookiesArray
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    Swal.fire('Success!', data.message, 'success');
                } else {
                    console.log('Error data:', data);
                    Swal.fire('Error!', data.error || 'An error occurred.', 'error');
                }
            } catch (error) {
                console.error('Request failed:', error);
                Swal.fire('Error!', 'An error occurred. Please try again later.', 'error');
            } finally {
                button.disabled = false;
                result.textContent = '';
            }
        }

        // Function to check server status
        async function checkServerStatus() {
            try {
                const response = await fetch('https://spamshare-api-git-main-lucifurges-projects-fee914f5.vercel.app/api/spam');
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('serverStatus').textContent = `Server status: ${data.message}`;
                } else {
                    document.getElementById('serverStatus').textContent = 'Server status: Error. Unable to fetch status.';
                }
            } catch (error) {
                document.getElementById('serverStatus').textContent = 'Server status: Error. Unable to connect.';
            }
        }

        // Check server status when page loads
        window.onload = checkServerStatus;
    </script>

    <!-- Bootstrap 5 JavaScript (for dropdown and mobile functionality) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
</body>

</html>
